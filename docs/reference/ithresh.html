<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Threshold selection in the i.i.d. case (peaks over threshold) — ithresh • threshr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Threshold selection in the i.i.d. case (peaks over threshold) — ithresh" />
<meta property="og:description" content="Produces a diagnostic plot to assist in the selection of an extreme value
threshold in the case where the data can be treated as independent and
identically distributed (i.i.d.) observations.  For example, it could be
that these observations are the cluster maxima resulting from the
declustering of time series data.  The predictive ability of models
fitted using each of a user-supplied set of thresholds is assessed using
leave-one-out cross-validation in a Bayesian setup.
These models are based on a Generalized Pareto (GP) distribution for
threshold excesses and a binomial model for the probability of threshold
exceedance.  See
Northrop et al. (2017)
for details." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">threshr</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/threshr-vignette.html">Introducing threshr: Threshold Selection and Uncertainty for Extreme Value Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/paulnorthrop/threshr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Threshold selection in the i.i.d. case (peaks over threshold)</h1>
    <small class="dont-index">Source: <a href='https://github.com/paulnorthrop/threshr/blob/master/R/ithresh.R'><code>R/ithresh.R</code></a></small>
    <div class="hidden name"><code>ithresh.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Produces a diagnostic plot to assist in the selection of an extreme value
threshold in the case where the data can be treated as independent and
identically distributed (i.i.d.) observations.  For example, it could be
that these observations are the cluster maxima resulting from the
declustering of time series data.  The predictive ability of models
fitted using each of a user-supplied set of thresholds is assessed using
leave-one-out cross-validation in a Bayesian setup.
These models are based on a Generalized Pareto (GP) distribution for
threshold excesses and a binomial model for the probability of threshold
exceedance.  See
<a href='https://doi.org/10.1111/rssc.12159'>Northrop et al. (2017)</a>
for details.</p>
    </div>

    <pre class="usage"><span class='fu'>ithresh</span>(<span class='no'>data</span>, <span class='no'>u_vec</span>, <span class='no'>...</span>, <span class='kw'>n_v</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>npy</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>use_rcpp</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A numeric vector of observations.  Any missing values will
be removed.  The argument <code>npy</code> (see below) may be supplied
as an attribute of <code>data</code> using <code>attr(data, "npy") &lt;- value</code>,
where <code>value</code> is the value of <code>npy</code> (see <code><a href='https://rdrr.io/r/base/attr.html'>attr</a></code>).
If <code>npy</code> is supplied twice, as both <code><a href='https://rdrr.io/r/base/attr.html'>attr(data, "npy")</a></code>)
and using the <code>npy</code> argument, then the former is used.</p></td>
    </tr>
    <tr>
      <th>u_vec</th>
      <td><p>A numeric vector. A vector of <em>training</em> thresholds
at which inferences are made from a binomial-GP model.  These could be
set at sample quantiles of  <code>data</code> using
<code><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></code>.  Any duplicated values will be removed.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further (optional) arguments to be passed to the
  <code><a href='https://rdrr.io/pkg/revdbayes/man/revdbayes.html'>revdbayes</a></code> function
  <code><a href='https://rdrr.io/pkg/revdbayes/man/rpost_rcpp.html'>rpost_rcpp</a></code> (or <code><a href='https://rdrr.io/pkg/revdbayes/man/rpost.html'>rpost</a></code>),
  which use the generalized ratio-of-uniforms method to simulate from
  extreme value posterior distributions.
  In particular:</p><ul>
<li><p><code>n</code> The size of the posterior sample used to perform
    predictive inference.  Default: <code>n = 1000</code>.</p></li>
<li><p><code>prior</code> A prior for GP parameters to be passed to the
    <strong>revdbayes</strong> function <code><a href='https://rdrr.io/pkg/revdbayes/man/set_prior.html'>set_prior</a></code>.
    Can be either a character scalar that chooses an in-built prior,
    or a user-supplied R function or pointer to a compiled C++ function.
    See the <code><a href='https://rdrr.io/pkg/revdbayes/man/set_prior.html'>set_prior</a></code> documentation for details
    of the in-built priors.
    See the <strong>revdbayes</strong> vignette
    <a href='https://cran.r-project.org/package=revdbayes'>Faster simulation
    using revdbayes</a> for information about creating
    a pointer to a C++ function.  See also the <strong>Examples</strong> section.    If the user supplies and R function then <code>rpost</code> will be
    used for posterior simulation, rather than (the faster)
    <code>rpost_rcpp</code>, regardless of the input value of
    <code>use_rcpp</code>.    Default: <code>prior = "mdi"</code> with <code>a = 0.6</code> and <code>min_xi = -1</code>.
    This particular prior is studied in
    <a href='https://doi.org/10.1111/rssc.12159'>Northrop et al. (2017)</a>.</p></li>
<li><p><code>h_prior</code> A <em>list</em> of further arguments
    (hyperparameters) for the GP prior specified in <code>prior</code>.</p></li>
<li><p><code>bin_prior</code> A prior for the threshold exceedance probability
    \(p\) to be passed to the <strong>revdbayes</strong> function
    <code><a href='https://rdrr.io/pkg/revdbayes/man/set_bin_prior.html'>set_bin_prior</a></code>.
    Can either be a character scalar that chooses an in-built prior,
    or a user_supplied R function.    Default: <code>prior = "jeffreys"</code>, i.e. Beta(1/2, 1/2).</p></li>
<li><p><code>h_bin_prior</code> A <em>list</em> of further arguments
    (hyperparameters) for the binomial prior specified in <code>bin_prior</code>.
    See the <code><a href='https://rdrr.io/pkg/revdbayes/man/set_bin_prior.html'>set_bin_prior</a></code> documentation for details
    of the in-built priors.</p></li>
<li><p><code>trans</code> A character scalar: either <code>"none"</code> or
    <code>"BC"</code>.  See <code>rpost_rcpp</code> for details.
    The default is <code>"none"</code>, which is usually faster than <code>"BC"</code>.
    However, if there are very few threshold excesses then using
    <code>trans = "BC"</code> can make the optimizations involved in the
    generalized ratio-of-uniforms algorithm more stable.  If using
    <code>trans = "none"</code> produces an error for a particular posterior
    simulation then <code>trans = "BC"</code> is used instead.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>n_v</th>
      <td><p>A numeric scalar.
Each of the <code>n_v</code> largest values in <code>u_vec</code> will be used
(separately) as a <em>validation</em> threshold for the training thresholds
in <code>u_vec</code> that lie at or below that validation threshold.
If <code>n_v = 1</code> then all the training thresholds are used with
validation performed using the threshold <code>u_vec[length(u_vec)]</code>.
If <code>n_v = 2</code> then, in addition, the assessment is performed using
<code>u_vec[1], ..., u_vec[length(u_vec) - 1]</code> with
validation threshold <code>u_vec[length(u_vec) - 1]</code>,
and so on.</p></td>
    </tr>
    <tr>
      <th>npy</th>
      <td><p>A numeric scalar. The mean number of observations per year
  of data, after excluding any missing values, i.e. the number of
  non-missing observations divided by total number of years of non-missing
  data.  May be supplied using as an attribute <code><a href='https://rdrr.io/r/base/attr.html'>attr(data, "npy")</a></code>
  of <code>data</code> instead.</p>
<p>The value of <code>npy</code> does not affect any calculation in
  <code>ithresh</code>, it only affects subsequent extreme value inferences using
  <code>predict.ithresh</code>.  However, setting <code>npy</code> in the call to
  <code>rpost</code>, or as an attribute of <code>data</code> avoids the need to
  supply <code>npy</code> when calling <code>predict.ithresh</code>.</p></td>
    </tr>
    <tr>
      <th>use_rcpp</th>
      <td><p>A logical scalar.  If <code>TRUE</code> (the default) the
revdbayes function <code><a href='https://rdrr.io/pkg/revdbayes/man/rpost_rcpp.html'>rpost_rcpp</a></code> is used for
posterior simulation.  If <code>FALSE</code>, or if the user supplies an R
function to set the prior for GP parameters,
the (slower) function <code><a href='https://rdrr.io/pkg/revdbayes/man/rpost.html'>rpost</a></code> is used.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object (list) of class <code>"ithresh"</code>, containing the
  components</p><ul>
<li><p><code>pred_perf</code>: A numeric matrix with <code><a href='https://rdrr.io/r/base/length.html'>length(u_vec)</a></code>
    rows and <code>n_v</code> columns.  Each column contains the values of
    the measure of predictive performance.  Entries corresponding
    to cases where the training threshold is above the validation
    threshold will be <code>NA</code>.</p></li>
<li><p><code>u_vec</code>: The argument <code>u_vec</code> to <code>ithresh</code>.</p></li>
<li><p><code>v_vec</code>: A numeric vector.  The validation thresholds
      implied by the argument <code>n_v</code> to <code>ithresh</code>.</p></li>
<li><p><code>u_ps</code>: A numeric vector. The approximate levels of the
      sample quantiles to which the values in <code>u_vec</code> correspond,
      i.e. the approximate percentage of the data the lie at or below
      each element in <code>u_vec</code>.</p></li>
<li><p><code>v_ps</code>: A numeric vector.  The values in <code>u_ps</code>
      that correspond to the validation thresholds.</p></li>
<li><p><code>sim_vals</code>: A numeric matrix with 4 columns and
      <code>n</code> x <code><a href='https://rdrr.io/r/base/length.html'>length(u_vec)</a></code> rows.  The \(j\)th block of
      <code>n</code> rows contains in columns 1-3 the posterior samples of
      the threshold exceedance probability, the GP scale
      parameter and the GP shape parameter respectively,
      based on training threshold <code>u_vec[i]</code>,
      and in column 4 the value of \(j\).</p></li>
<li><p><code>n</code>: A numeric scalar.  The value of <code>n</code>.</p></li>
<li><p><code>npy</code>: A numeric scalar.  The value of <code>npy</code>.</p></li>
<li><p><code>data</code>: The argument <code>data</code> to <code>ithresh</code>
      detailed above, with any missing values removed.</p></li>
<li><p><code>use_rcpp</code>: A logical scalar indicating whether
      <code><a href='https://rdrr.io/pkg/revdbayes/man/rpost_rcpp.html'>rpost_rcpp</a></code> (<code>use_rcpp = TRUE</code>) or
      <code><a href='https://rdrr.io/pkg/revdbayes/man/rpost.html'>rpost</a></code> (<code>use_rcpp = FALSE</code>)
      was used for posterior simulation.</p></li>
<li><p><code>for_post</code>: A list containing arguments with which
      <code><a href='https://rdrr.io/pkg/revdbayes/man/rpost_rcpp.html'>rpost_rcpp</a></code>
      (or <code><a href='https://rdrr.io/pkg/revdbayes/man/rpost.html'>rpost</a></code>) was called, including
      any user-supplied arguments to these functions.</p></li>
<li><p><code>call:</code> The call to <code>ithresh</code>.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For a given threshold in <code>u_vec</code>:</p><ul>
<li><p>the number of values in <code>data</code> that exceed the threshold,
    and the amounts (the <em>threshold excesses</em>) by which these value
    exceed the threshold are calculated;</p></li>
<li><p><code><a href='https://rdrr.io/pkg/revdbayes/man/rpost_rcpp.html'>rpost_rcpp</a></code>
    (or <code><a href='https://rdrr.io/pkg/revdbayes/man/rpost.html'>rpost</a></code>) is used to sample from the posterior
    distributions of the parameters of a GP model for the threshold
    excesses and a binomial model for the probability of threshold
    exceedance;</p></li>
<li><p>the ability of this binomial-GP model to predict data
    thresholded at the validation threshold(s) specified by <code>n_v</code> is
    assessed using leave-one-out cross-validation (the measure of
    this is given in equation (7) of
    <a href='https://doi.org/10.1111/rssc.12159'>Northrop et al. (2017)</a>).</p></li>
</ul><p>See <a href='https://doi.org/10.1111/rssc.12159'>Northrop et al. (2017)</a>
  and the introductory threshr vignette for further details and examples.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Northrop, P.J. and Attalides, N. (2016) Posterior propriety in
  Bayesian extreme value analyses using reference priors
  <em>Statistica Sinica</em>, <strong>26</strong>(2), 721--743
  <a href='https://doi.org/10.5705/ss.2014.034'>https://doi.org/10.5705/ss.2014.034</a>.</p>
<p>Northrop, P. J., Attalides, N. and Jonathan, P. (2017)
  Cross-validatory extreme value threshold selection and uncertainty
  with application to ocean storm severity.
  <em>Journal of the Royal Statistical Society Series C: Applied
  Statistics</em>, <strong>66</strong>(1), 93-120.
  <a href='https://doi.org/10.1111/rssc.12159'>https://doi.org/10.1111/rssc.12159</a></p>
<p>Jonathan, P. and Ewans, K. (2013) Statistical modelling
  of extreme ocean environments for marine design : a review.
  <em>Ocean Engineering</em>, <strong>62</strong>, 91-109.
  <a href='https://doi.org/10.1016/j.oceaneng.2013.01.004'>https://doi.org/10.1016/j.oceaneng.2013.01.004</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='plot.ithresh.html'>plot.ithresh</a></code> for the S3 plot method for objects of
  class <code>ithresh</code>.</p>
<p><code><a href='summary.ithresh.html'>summary.ithresh</a></code> Summarizing measures of threshold
  predictive performance.</p>
<p><code><a href='predict.ithresh.html'>predict.ithresh</a></code> for predictive inference for the
  largest value observed in N years.</p>
<p><code><a href='https://rdrr.io/pkg/revdbayes/man/rpost.html'>rpost</a></code> in the
  <code><a href='https://rdrr.io/pkg/revdbayes/man/revdbayes.html'>revdbayes</a></code> package for details of the arguments
  that can be passed to
  <code><a href='https://rdrr.io/pkg/revdbayes/man/rpost_rcpp.html'>rpost_rcpp</a></code>/<code><a href='https://rdrr.io/pkg/revdbayes/man/rpost.html'>rpost</a></code>.</p>
<p><code><a href='https://rdrr.io/pkg/revdbayes/man/set_prior.html'>set_prior</a></code> and
  <code><a href='https://rdrr.io/pkg/revdbayes/man/set_bin_prior.html'>set_bin_prior</a></code> in the
  <code><a href='https://rdrr.io/pkg/revdbayes/man/revdbayes.html'>revdbayes</a></code> package for details of how to set a
  prior distributions for GP parameters and for the exceedance probability
  \(p\).</p>
<p><code><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Note:</span>
<span class='co'># 1. Smoother plots result from making n larger than the default n = 1000.</span>
<span class='co'># 2. In some examples below validation thresholds rather higher than is</span>
<span class='co'>#    advisable have been used, with far fewer excesses than the minimum of</span>
<span class='co'>#    50 suggested by Jonathan and Ewans (2013).</span>

<span class='co'>## North Sea significant wave heights, default prior -----------------------</span>
<span class='co'>#' # A plot akin to the top left of Figure 7 in Northrop et al. (2017)</span>
<span class='co'>#' # ... but with fewer training thresholds</span>

<span class='no'>u_vec_ns</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span>(<span class='no'>ns</span>, <span class='kw'>probs</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0.1</span>, <span class='fl'>0.9</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='fl'>0.1</span>))
<span class='no'>ns_cv</span> <span class='kw'>&lt;-</span> <span class='fu'>ithresh</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>ns</span>, <span class='kw'>u_vec</span> <span class='kw'>=</span> <span class='no'>u_vec_ns</span>, <span class='kw'>n_v</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>ns_cv</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>add_legend</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>legend_pos</span> <span class='kw'>=</span> <span class='st'>"topright"</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/mtext.html'>mtext</a></span>(<span class='st'>"significant wave height / m"</span>, <span class='kw'>side</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>line</span> <span class='kw'>=</span> <span class='fl'>2.5</span>)</div><div class='img'><img src='ithresh-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Gulf of Mexico significant wave heights, default prior ------------------</span>

<span class='no'>u_vec_gom</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span>(<span class='no'>gom</span>, <span class='kw'>probs</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0.2</span>, <span class='fl'>0.9</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='fl'>0.1</span>))
<span class='co'># Setting a prior using its name and parameter value(s) --------------------</span>
<span class='co'># This example gives the same prior as the default</span>
<span class='no'>gom_cv</span> <span class='kw'>&lt;-</span> <span class='fu'>ithresh</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>gom</span>, <span class='kw'>u_vec</span> <span class='kw'>=</span> <span class='no'>u_vec_gom</span>, <span class='kw'>n_v</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='st'>"mdi"</span>,
                  <span class='kw'>h_prior</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>a</span> <span class='kw'>=</span> <span class='fl'>0.6</span>))

<span class='co'>## Setting a user-defined (log-)prior R function ---------------------------</span>
<span class='co'># This example also gives the same prior as the default</span>
<span class='co'># (It will take longer to run than the example above because ithresh detects</span>
<span class='co'>#  that the prior is an R function and sets use_rcpp to FALSE.)</span>
<span class='co'># \donttest{</span>
<span class='no'>user_prior</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>pars</span>, <span class='no'>a</span>, <span class='no'>min_xi</span> <span class='kw'>=</span> -<span class='fl'>1</span>) {
  <span class='kw'>if</span> (<span class='no'>pars</span>[<span class='fl'>1</span>] <span class='kw'>&lt;=</span> <span class='fl'>0</span> <span class='kw'>|</span> <span class='no'>pars</span>[<span class='fl'>2</span>] <span class='kw'>&lt;</span> <span class='no'>min_xi</span>) {
    <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(-<span class='fl'>Inf</span>)
  }
  <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(-<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>pars</span>[<span class='fl'>1</span>]) - <span class='no'>a</span> * <span class='no'>pars</span>[<span class='fl'>2</span>])
}
<span class='no'>user_bin_prior</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>p</span>, <span class='no'>ab</span>) {
  <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(<span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Beta.html'>dbeta</a></span>(<span class='no'>p</span>, <span class='kw'>shape1</span> <span class='kw'>=</span> <span class='no'>ab</span>[<span class='fl'>1</span>], <span class='kw'>shape2</span> <span class='kw'>=</span> <span class='no'>ab</span>[<span class='fl'>2</span>], <span class='kw'>log</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>))
}
<span class='no'>gom_cv</span> <span class='kw'>&lt;-</span> <span class='fu'>ithresh</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>gom</span>, <span class='kw'>u_vec</span> <span class='kw'>=</span> <span class='no'>u_vec_gom</span>, <span class='kw'>n_v</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='no'>user_prior</span>,
                  <span class='kw'>h_prior</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>a</span> <span class='kw'>=</span> <span class='fl'>0.6</span>), <span class='kw'>bin_prior</span> <span class='kw'>=</span> <span class='no'>user_bin_prior</span>,
                  <span class='kw'>h_bin_prior</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>ab</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span> / <span class='fl'>2</span>, <span class='fl'>1</span> / <span class='fl'>2</span>)))
<span class='co'># }</span>
<span class='co'>## Setting a user-defined (log-)prior (pointer to a) C++ function ----------</span>
<span class='co'># We make use of a C++ function and function create_prior_xptr() to create</span>
<span class='co'># the required pointer from the revdbayes package</span>

<span class='no'>prior_ptr</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>revdbayes</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/revdbayes/man/create_prior_xptr.html'>create_prior_xptr</a></span>(<span class='st'>"gp_flat"</span>)
<span class='no'>gom_cv</span> <span class='kw'>&lt;-</span> <span class='fu'>ithresh</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>gom</span>, <span class='kw'>u_vec</span> <span class='kw'>=</span> <span class='no'>u_vec_gom</span>, <span class='kw'>n_v</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='no'>prior_ptr</span>,
                  <span class='kw'>h_prior</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>min_xi</span> <span class='kw'>=</span> -<span class='fl'>1</span>))</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Paul J. Northrop, Nicolas Attalides.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


