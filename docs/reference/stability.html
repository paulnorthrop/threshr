<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generalized Pareto parameter estimate stability — stability • threshr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generalized Pareto parameter estimate stability — stability"><meta property="og:description" content="Uses maximum likelihood estimation to fit a Generalized Pareto (GP)
model to threshold excesses over a range of thresholds.
The threshold excesses are treated as independent and identically
distributed (i.i.d.) observations.
The resulting estimates and confidence intervals can be plotted,
using plot.stability,
to produce a crude graphical diagnostic for threshold choice."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">threshr</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/threshr-vignette.html">Introducing threshr: Threshold Selection and Uncertainty for Extreme Value Analysis</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/paulnorthrop/threshr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generalized Pareto parameter estimate stability</h1>
    <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/threshr/blob/HEAD/R/parameter_stability.R" class="external-link"><code>R/parameter_stability.R</code></a></small>
    <div class="hidden name"><code>stability.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Uses maximum likelihood estimation to fit a Generalized Pareto (GP)
model to threshold excesses over a range of thresholds.
The threshold excesses are treated as independent and identically
distributed (i.i.d.) observations.
The resulting estimates and confidence intervals can be plotted,
using <code><a href="plot.stability.html">plot.stability</a></code>,
to produce a crude graphical diagnostic for threshold choice.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stability</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">u_vec</span>,</span>
<span>  prof <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  conf <span class="op">=</span> <span class="fl">95</span>,</span>
<span>  mult <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,</span>
<span>  plot_prof <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>A numeric vector of observations.</p></dd>


<dt>u_vec</dt>
<dd><p>A numeric vector of thresholds to be applied to the data.
Any duplicated values will be removed.  These could be set at sample
quantiles of <code>data</code> using <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></code>.</p></dd>


<dt>prof</dt>
<dd><p>A logical scalar.  Whether to calculate confidence intervals
for the GP shape parameter \(\xi\) based on the profile-likelihood
for \(\xi\) or using the MLE plus or minus a multiple of the estimated
standard error (SE) of the MLE.  The intervals produced by the former
may be better but they take longer to calculate.
Default: <code>FALSE</code>.</p></dd>


<dt>conf</dt>
<dd><p>A numeric scalar in (0, 100).  Confidence level for the
confidence intervals.  Default: 95%.</p></dd>


<dt>mult</dt>
<dd><p>A numeric vector of length 2.  The range of values over
which the profile log-likelihood for \(\xi\) is calculated is
(MLE - <code>mult[1]</code> c SE, MLE + <code>mult[2]</code> c SE),
where MLE and SE are the MLE and estimated standard error of \(\xi\)
and c is the constant for which this interval gives
an approximate 100<code>conf</code>% level confidence interval for \(\xi\)
when <code>mult = c(1, 1)</code>.  The default, <code>mult = c(1, 2)</code>, works
well in most cases.  If the routine fails because the range of \(\xi\)
is not sufficiently wide then the relevant components of <code>mult</code>
should be increased.</p></dd>


<dt>plot_prof</dt>
<dd><p>A logical scalar.  Only relevant if <code>prof = TRUE</code>.
If <code>plot_prof = TRUE</code> then the profile log-likelihood is plotted
for each threshold.  If <code>FALSE</code> then nothing is plotted.</p></dd>


<dt>...</dt>
<dd><p>Further (optional) arguments to be passed to the
<code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> function for the optimizations on which
the profile-likelihood for \(xi\) is based.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object (list) of class <code>"stability"</code> with components:</p>
<dl><dt>ests</dt>
<dd><p>MLEs of the GP shape parameter \(\xi\).</p></dd>

    <dt>ses</dt>
<dd><p>Estimated SEs of the MLEs of \(\xi\).</p></dd>

    <dt>lower</dt>
<dd><p>Lower limit of 100<code>conf</code>% confidence intervals
     for \(\xi\).</p></dd>

    <dt>upper</dt>
<dd><p>Upper limit of 100<code>conf</code>% confidence intervals
     for \(\xi\).</p></dd>

    <dt>nexc</dt>
<dd><p>The number of threshold excesses.</p></dd>

    <dt>u_vec</dt>
<dd><p>The thresholds supplied by the user.</p></dd>

    <dt>u_ps</dt>
<dd><p>The approximate sample quantiles to which the thresholds
     in <code>u_vec</code> correspond.</p></dd>

    <dt>data</dt>
<dd><p>The input <code>data</code>.</p></dd>

    <dt>conf</dt>
<dd><p>The input <code>conf</code>.</p></dd>

</dl><p>Each of these components is a numeric vector of length
<code>length(u_vec)</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>For each threshold in <code>u_vec</code> a GP model is fitted by maximum
  likelihood estimation to the threshold excesses, i.e. the amounts
  by which the data exceed that threshold.  The MLEs of the GP shape
  parameter \(\xi\) and approximate <code>conf</code>% confidence intervals
  for \(\xi\) are stored for plotting (by <code><a href="plot.stability.html">plot.stability</a></code>)
  to produce a simple graphical diagnostic to inform threshold selection.
  This plot is used to choose a threshold above which the underlying GP
  shape parameter may be approximately constant. See Chapter 4 of
  Coles (2001).  See also the vignette "Introducing threshr".</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Coles, S. G. (2001) <em>An Introduction to Statistical
  Modeling of Extreme Values</em>, Springer-Verlag, London.
  <a href="https://doi.org/10.1007/978-1-4471-3675-0_3" class="external-link">doi:10.1007/978-1-4471-3675-0_3</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ithresh.html">ithresh</a></code> for threshold selection in the i.i.d. case
  based on leave-one-out cross-validation.</p>
<p><code><a href="plot.stability.html">plot.stability</a></code> for the S3 <code>plot</code> method for
  objects of class <code>stability</code>.</p>
<p><code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Set a vector of thresholds</span></span></span>
<span class="r-in"><span><span class="va">u_vec_gom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">gom</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Symmetric confidence intervals</span></span></span>
<span class="r-in"><span><span class="va">gom_stab</span> <span class="op">&lt;-</span> <span class="fu">stability</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gom</span>, u_vec <span class="op">=</span> <span class="va">u_vec_gom</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gom_stab</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stability-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Profile-likelihood-based confidence intervals</span></span></span>
<span class="r-in"><span><span class="va">gom_stab</span> <span class="op">&lt;-</span> <span class="fu">stability</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gom</span>, u_vec <span class="op">=</span> <span class="va">u_vec_gom</span>, prof <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting at threshold number ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gom_stab</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stability-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Paul J. Northrop, Nicolas Attalides.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

