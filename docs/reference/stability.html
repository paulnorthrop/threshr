<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generalized Pareto parameter estimate stability — stability • threshr</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generalized Pareto parameter estimate stability — stability"><meta name="description" content="Uses maximum likelihood estimation to fit a Generalized Pareto (GP)
model to threshold excesses over a range of thresholds.
The threshold excesses are treated as independent and identically
distributed (i.i.d.) observations.
The resulting estimates and confidence intervals can be plotted,
using plot.stability,
to produce a crude graphical diagnostic for threshold choice."><meta property="og:description" content="Uses maximum likelihood estimation to fit a Generalized Pareto (GP)
model to threshold excesses over a range of thresholds.
The threshold excesses are treated as independent and identically
distributed (i.i.d.) observations.
The resulting estimates and confidence intervals can be plotted,
using plot.stability,
to produce a crude graphical diagnostic for threshold choice."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">threshr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/threshr-vignette.html">Introducing threshr: Threshold Selection and Uncertainty for Extreme Value Analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/paulnorthrop/threshr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generalized Pareto parameter estimate stability</h1>
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/threshr/blob/HEAD/R/parameter_stability.R"><code>R/parameter_stability.R</code></a></small>
      <div class="d-none name"><code>stability.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses maximum likelihood estimation to fit a Generalized Pareto (GP)
model to threshold excesses over a range of thresholds.
The threshold excesses are treated as independent and identically
distributed (i.i.d.) observations.
The resulting estimates and confidence intervals can be plotted,
using <code><a href="plot.stability.html">plot.stability</a></code>,
to produce a crude graphical diagnostic for threshold choice.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stability</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">u_vec</span>,</span>
<span>  prof <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  conf <span class="op">=</span> <span class="fl">95</span>,</span>
<span>  mult <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,</span>
<span>  plot_prof <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A numeric vector of observations.</p></dd>


<dt id="arg-u-vec">u_vec<a class="anchor" aria-label="anchor" href="#arg-u-vec"></a></dt>
<dd><p>A numeric vector of thresholds to be applied to the data.
Any duplicated values will be removed.  These could be set at sample
quantiles of <code>data</code> using <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></code>.</p></dd>


<dt id="arg-prof">prof<a class="anchor" aria-label="anchor" href="#arg-prof"></a></dt>
<dd><p>A logical scalar.  Whether to calculate confidence intervals
for the GP shape parameter \(\xi\) based on the profile-likelihood
for \(\xi\) or using the MLE plus or minus a multiple of the estimated
standard error (SE) of the MLE.  The intervals produced by the former
may be better but they take longer to calculate.
Default: <code>FALSE</code>.</p></dd>


<dt id="arg-conf">conf<a class="anchor" aria-label="anchor" href="#arg-conf"></a></dt>
<dd><p>A numeric scalar in (0, 100).  Confidence level for the
confidence intervals.  Default: 95%.</p></dd>


<dt id="arg-mult">mult<a class="anchor" aria-label="anchor" href="#arg-mult"></a></dt>
<dd><p>A numeric vector of length 2.  The range of values over
which the profile log-likelihood for \(\xi\) is calculated is
(MLE - <code>mult[1]</code> c SE, MLE + <code>mult[2]</code> c SE),
where MLE and SE are the MLE and estimated standard error of \(\xi\)
and c is the constant for which this interval gives
an approximate 100<code>conf</code>% level confidence interval for \(\xi\)
when <code>mult = c(1, 1)</code>.  The default, <code>mult = c(1, 2)</code>, works
well in most cases.  If the routine fails because the range of \(\xi\)
is not sufficiently wide then the relevant components of <code>mult</code>
should be increased.</p></dd>


<dt id="arg-plot-prof">plot_prof<a class="anchor" aria-label="anchor" href="#arg-plot-prof"></a></dt>
<dd><p>A logical scalar.  Only relevant if <code>prof = TRUE</code>.
If <code>plot_prof = TRUE</code> then the profile log-likelihood is plotted
for each threshold.  If <code>FALSE</code> then nothing is plotted.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further (optional) arguments to be passed to the
<code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> function for the optimizations on which
the profile-likelihood for \(xi\) is based.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object (list) of class <code>"stability"</code> with components:</p>
<dl><dt>ests</dt>
<dd><p>MLEs of the GP shape parameter \(\xi\).</p></dd>

    <dt>ses</dt>
<dd><p>Estimated SEs of the MLEs of \(\xi\).</p></dd>

    <dt>lower</dt>
<dd><p>Lower limit of 100<code>conf</code>% confidence intervals
     for \(\xi\).</p></dd>

    <dt>upper</dt>
<dd><p>Upper limit of 100<code>conf</code>% confidence intervals
     for \(\xi\).</p></dd>

    <dt>nexc</dt>
<dd><p>The number of threshold excesses.</p></dd>

    <dt>u_vec</dt>
<dd><p>The thresholds supplied by the user.</p></dd>

    <dt>u_ps</dt>
<dd><p>The approximate sample quantiles to which the thresholds
     in <code>u_vec</code> correspond.</p></dd>

    <dt>data</dt>
<dd><p>The input <code>data</code>.</p></dd>

    <dt>conf</dt>
<dd><p>The input <code>conf</code>.</p></dd>

</dl><p>Each of these components is a numeric vector of length
<code>length(u_vec)</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For each threshold in <code>u_vec</code> a GP model is fitted by maximum
  likelihood estimation to the threshold excesses, i.e. the amounts
  by which the data exceed that threshold.  The MLEs of the GP shape
  parameter \(\xi\) and approximate <code>conf</code>% confidence intervals
  for \(\xi\) are stored for plotting (by <code><a href="plot.stability.html">plot.stability</a></code>)
  to produce a simple graphical diagnostic to inform threshold selection.
  This plot is used to choose a threshold above which the underlying GP
  shape parameter may be approximately constant. See Chapter 4 of
  Coles (2001).  See also the vignette "Introducing threshr".</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Coles, S. G. (2001) <em>An Introduction to Statistical
  Modeling of Extreme Values</em>, Springer-Verlag, London.
  <a href="https://doi.org/10.1007/978-1-4471-3675-0_3" class="external-link">doi:10.1007/978-1-4471-3675-0_3</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ithresh.html">ithresh</a></code> for threshold selection in the i.i.d. case
  based on leave-one-out cross-validation.</p>
<p><code><a href="plot.stability.html">plot.stability</a></code> for the S3 <code>plot</code> method for
  objects of class <code>stability</code>.</p>
<p><code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Set a vector of thresholds</span></span></span>
<span class="r-in"><span><span class="va">u_vec_gom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">gom</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Symmetric confidence intervals</span></span></span>
<span class="r-in"><span><span class="va">gom_stab</span> <span class="op">&lt;-</span> <span class="fu">stability</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gom</span>, u_vec <span class="op">=</span> <span class="va">u_vec_gom</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gom_stab</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stability-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Profile-likelihood-based confidence intervals</span></span></span>
<span class="r-in"><span><span class="va">gom_stab</span> <span class="op">&lt;-</span> <span class="fu">stability</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gom</span>, u_vec <span class="op">=</span> <span class="va">u_vec_gom</span>, prof <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting at threshold number ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gom_stab</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stability-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul J. Northrop, Nicolas Attalides.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

